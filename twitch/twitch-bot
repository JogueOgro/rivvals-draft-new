const tmi = require('tmi.js')
const https = require('https')
const fetch = require('node-fetch')
require('dotenv').config()

const options = {
  options: {
    debug: true,
  },
  connection: {
    cluster: 'aws',
    reconnect: true,
  },
  identity: {
    username: process.env.TWITCH_BOT_USERNAME,
    password: process.env.TWITCH_OAUTH_TOKEN,
  },
  channels: ['rivvalsgg'],
}

const client = new tmi.client(options)
client.connect()

// client.mess

client.on('connected', function (address, port) {
  client.action('rivvalsgg', 'Rivvals Draft ONLINE!')
})

client.on('chat', function (channel, user, message, self) {
  // Don't listen to my own messages..
  if (self) return

  if (message.substring(0, 7) === '!anular') {
    client.action(
      'rivvalsgg',
      '@' + user.username.toLowerCase() + ' -- Comando anular utilizado!',
    )
  }
})
